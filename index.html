<!DOCTYPE html>
<html>
<head>
  <title>Swiggy Style Route Demo</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    html, body, #map { height: 100%; margin: 0; padding: 0; }
  </style>
</head>
<body>
  <div id="map"></div>

  <script>
    // 🗺️ Coordinates
    const source = [23.0225, 72.5714];       // Restaurant (Ahmedabad)
    const destination = [23.2156, 72.6369];  // Customer (Gandhinagar)

    const iconUrl = "https://www.silvertouch.com/mailer/fire-masal.png";
    const icon = L.icon({
      iconUrl,
      iconSize: [40, 40],
      iconAnchor: [20, 40],
      popupAnchor: [0, -40]
    });

    // 🗺️ Init Map
    const map = L.map("map").setView(source, 11);

    L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
      attribution: "&copy; OpenStreetMap contributors"
    }).addTo(map);

    // Markers
    const srcMarker = L.marker(source, { icon }).addTo(map).bindPopup("Restaurant").openPopup();
    const dstMarker = L.marker(destination, { icon }).addTo(map).bindPopup("Customer");

    // 🧭 Draw Route using OpenRouteService
    const apiKey = "5b3ce3597851110001cf6248c9d85902f070459d880c6a22a6e467d6"; // Your ORS key
    const url = "https://api.openrouteservice.org/v2/directions/foot-walking";

    fetch(url, {
      method: "POST",
      headers: {
        'Authorization': apiKey,
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        coordinates: [
          [source[1], source[0]],
          [destination[1], destination[0]]
        ]
      })
    })
    .then(res => res.json())
    .then(data => {
      const coords = data.features[0].geometry.coordinates.map(c => [c[1], c[0]]);
      L.polyline(coords, { color: "blue", weight: 5 }).addTo(map);
    })
    .catch(err => {
      console.error("Routing error:", err);
      alert("Failed to load route.");
    });
  </script>
</body>
</html>
